---
layout: post
title: STM32F7's GPIO
category: programming
---

I'm using a discovery board based on STM32F74XX microcontroller, and in this post I'll explain the how GPIOs works and how to configure them using C code. 

# Electrical diagram 
A general purpose Input/Output pin has the following structure when is configured as an **input** and as an **output**.

![I/O diagram](/images/posts/gpio_diagram.png)

(a) **Input**: _IN_ is the signal from the microprocessor, _Ru_ is the pull-up resistor, _Rd_ is the pull-down resistor.  
(b) **Output**: _OUT_ is the signal from the microprocessor, which goes to two enhancement MOSFETs (_P-MOS_ and _N-MOS_).  


The I/O pins can have **several states**:
- Input: 
    - **Pull-up**: in this mode the input voltage of the pin is fixed to **VCC** or **1** when there is **no input signal**
    - **Pull-down**: in this mode the input voltage of the pin is fixed to **VSS** or **0** when there is **no input signal**
    - **Floating**: in this mode the value of the input is **undefined** when there is **no input signal** because the pin is _floating_.

![Input states](/images/posts/gpio_inputs.png)

- Output: 
    - **push-pull**: is the normal or most common state, in this state the output can be **VCC / 1** when _OUT_ is **1**, or  **VSS/0** when _OUT_ is **0**.
    - **open-drain**: this state is similar to the floating state when the pin is configured as input. When _OUT_ is **1** the pin is _floating_ or the _drain_ pin of the MOSFET is _open_, and when _OUT_ is **0** the pin is **VSS**

More detailed information in this application note [AN4899](https://comm.eefocus.com/media/download/index/id-1013834): _STM32 GPIO configuration for hardware settings and low-power consumption_.

![Output states](/images/posts/gpio_outputs.png)

Also, when the output is in open-drain state, it can be combined with pull-up/down resistors in order to have a fixed  output voltage when MOSFET is not activated.

![Output states](/images/posts/gpio_opendrain_re.png)

There are two  more  possible configurations: _Analog_ and _Alternate function_, but I didn't read about it. Sorry folks. 

# STM32F7 GPIO Registers 

# GPIO basic configuration

# Summary / Conclusion

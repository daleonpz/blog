---
layout: post
title: Embedded Ada Journey 002 - Testing my toolchain
category: programming
---

In the last post I talked about the tools I use to do my development and the board I bought. 
Today, I will talk about the first toolchain test I did.

# First step 
You should download the *Ada Drivers Library* from [github](https://github.com/AdaCore/Ada_Drivers_Library). 
Then, change to `Ada_Drivers_Library/examples/STM32F746_Discovery`, in my case is STM32F746. You will find examples for _STM32F429_, _STM32F469_, _STM32F4_, _STM32F746_, and _STM32F769_

# Cross compiling
* Execute `gprbuild blinky_f7disco.gpr`. What is GPRbuild? From AdaCore documentation.
_GPRbuild is a generic build tool designed for the construction of large multi-language systems organized into subsystems and libraries. It is well-suited for compiled languages supporting separate compilation, such as Ada, C, C++ and Fortran._
More info [here](https://docs.adacore.com/gprbuild-docs/html/gprbuild_ug/building_with_gprbuild.html).

And it has three phases: Compilation, post-compilation (binding) and linking phase. You will see, after executing `gprbuild`, something similar to the following:

```sh
Compile
   [Ada]          blinky.adb
   [Ada]          last_chance_handler.adb
Bind
   [gprbind]      blinky.bexch
   [Ada]          blinky.ali
Link
   [link]         blinky.adb
Memory region         Used Size  Region Size  %age Used
            itcm:          0 GB        16 KB      0.00%
           flash:      139420 B         1 MB     13.30%
            dtcm:          0 GB        64 KB      0.00%
          sram12:       26368 B       240 KB     10.73%
```

* Go to `Ada_Drivers_Library/examples/shared/hello_world_blinky/obj/stm32f7disco`. In that file you will find a bunch of files. But for now we will focus on `blinky`

```sh
-rwxr-xr-x 1 dnl dnl 966252 05.02.2018 15:58 blinky*
``` 

# Flashing
* Before flashing our executable we must convert it to a binary file `arm-eabi-objcopy -O binary blinky blinky.bin`. The `-O` recieve a `bfdname` as the object format for both the input and the output file. From the help page `[-O bfdnameâŽª--output-target=bfdname]`.

The diffe

